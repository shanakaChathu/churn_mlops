schema: '2.0'
stages:
  raw_dataset_creation:
    cmd: python src/data/get_data.py --config=params.yaml
    deps:
    - path: data/external/train.csv
      md5: 8929517566f004183dff480fdd48afe0
      size: 391872
    - path: src/data/get_data.py
      md5: 23b6a2e834f0f65b79b8ead91f60049f
      size: 2678
    outs:
    - path: data/raw/test_week1.csv
      md5: 9fa5eb634e0fae0ea97554fbb4926827
      size: 59063
    - path: data/raw/test_week2.csv
      md5: 241aea5f0c5951d7a3bb5f118a60e6a5
      size: 59203
    - path: data/raw/train.csv
      md5: e7e56c645b29ef0eec041e1293327ed1
      size: 274282
  split_data:
    cmd: python src/data/split_data.py --config=params.yaml
    deps:
    - path: data/raw/train.csv
      md5: e7e56c645b29ef0eec041e1293327ed1
      size: 274282
    - path: src/data/split_data.py
      md5: 90ef0074352427cd41b1b8e41796eb74
      size: 1242
    outs:
    - path: data/processed/churn_test.csv
      md5: cbe461f611a83ee82666622dbaee8e2b
      size: 55173
    - path: data/processed/churn_train.csv
      md5: 5821af312e680407f3472f56e405e9bc
      size: 219447
  train_and_evaluate:
    cmd: python src/models/train_model.py --config=params.yaml
    deps:
    - path: data/processed/churn_test.csv
      md5: cbe461f611a83ee82666622dbaee8e2b
      size: 55173
    - path: data/processed/churn_train.csv
      md5: 5821af312e680407f3472f56e405e9bc
      size: 219447
    - path: src/models/train_model.py
      md5: f6b8967573126d37339cdb02d12b629e
      size: 4429
    params:
      params.yaml:
        random_forest.max_depth: 2
        random_forest.max_features: 2
        random_forest.n_estimators: 20
  log_production_model:
    cmd: python src/models/log_production_model.py --config=params.yaml
    deps:
    - path: src/models/log_production_model.py
      md5: f13ba0fcfe1f9cbf4899747c1de35fed
      size: 1738
    params:
      params.yaml:
        random_forest.max_depth: 2
        random_forest.max_features: 2
        random_forest.n_estimators: 20
    outs:
    - path: models/model.joblib
      md5: b91a39d649eb5a4cf20799e79ea1eae2
      size: 85928
  prediction_service:
    cmd: python src/prediction_service/prediction.py --config=params.yaml
    deps:
    - path: data/raw/test_week1.csv
      md5: 9fa5eb634e0fae0ea97554fbb4926827
      size: 59063
    - path: models/model.joblib
      md5: b91a39d649eb5a4cf20799e79ea1eae2
      size: 85928
    - path: src/prediction_service/prediction.py
      md5: 907516105ea885d1db8601060bc74987
      size: 1383
    outs:
    - path: data/prediction/prediction.csv
      md5: 4d016ca99f60b33439c2510015ae50c4
      size: 60985
  model_monitor:
    cmd: python src/model_monitoring/model_monitor.py --config=params.yaml
    deps:
    - path: data/processed/churn_train.csv
      md5: 5821af312e680407f3472f56e405e9bc
      size: 219447
    - path: data/raw/test_week1.csv
      md5: 9fa5eb634e0fae0ea97554fbb4926827
      size: 59063
    - path: src/model_monitoring/model_monitor.py
      md5: aed0cae3dba36bc8d854d941684440eb
      size: 1916
    outs:
    - path: reports/data_and_target_drift_dashboard.html
      md5: 674493e19b6e0a260e56fbac0054bad6
      size: 7332825
